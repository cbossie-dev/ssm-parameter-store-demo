parameters:
- name: EcrRepository
  type: string
- name: BuildId
  type: string
- name: region
  type: string


steps:
# Step 1 - Docker Build the Visual Studio Project
- task: Docker@2
  inputs:
    repository: '${{ parameters.EcrRepository }}'
    command: 'build'
    Dockerfile: '$(Build.Repository.LocalPath)/param-web-app/param-web-app/Dockerfile'

# Step 2 - Deploy Container to ECR
- task: ECRPushImage@1
  inputs:
    awsCredentials: 'AWS-Dotnet-Ohio'
    region: '${{ parameters.region }}'
    imageSource: 'imagename'
    sourceImageName: '${{ parameters.EcrRepository }}'
    sourceImageTag: '${{ parameters.BuildId }}'
    repositoryName: '${{ parameters.EcrRepository }}'
    autoCreateRepository: true

